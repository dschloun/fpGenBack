databaseChangeLog:
  - changeSet:
      id: create_generation_search_view
      author: dsc
      changes:
        - createView:
            viewName: generation_search_view
            replaceIfExists: true
            encoding: UTF-8
            selectQuery: select
              CAST(g.id as varchar) as id,
              g.creation_date as creation_date,
              g.kind as kind,
              g.generation_id as generation_id,
              a.trigram as author_trigram,
              g.details as details,
              g.user_prompt as user_prompt,
              g.topic as topic,
              g.type as type,
              g.quantity as quantity,
              CAST(gdj.dataset_id as varchar) as dataset_id
              from generation g 
              left join dataset_generation_join_table gdj 
              on g.id = gdj.generation_id
              inner join author a
              on g.author_id = a.id;

  - changeSet:
      id: create_statistic_helper_view
      author: dsc
      changes:
        - createView:
            viewName: statistic_helper_view
            replaceIfExists: true
            encoding: UTF-8
            selectQuery: select
              CAST(d.id as varchar) as dataset_id,
              CAST(g.id as varchar) as generation_id,
              g.type as message_type,
              g.topic as message_topic,
              g.quantity as message_quantity
              from dataset d
              inner join dataset_generation_join_table dgj
              on d.id = dgj.dataset_id
              inner join generation g
              on dgj.generation_id = g.id;